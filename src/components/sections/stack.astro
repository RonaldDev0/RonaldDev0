---
import { Image } from 'astro:assets'
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card'

// Import frontend images
import html5Icon from '../../assets/stack/frontend/html5.svg'
import cssIcon from '../../assets/stack/frontend/css_old.svg'
import javascriptIcon from '../../assets/stack/frontend/javascript.svg'
import typescriptIcon from '../../assets/stack/frontend/typescript.svg'
import reactIcon from '../../assets/stack/frontend/react_dark.svg'
import tailwindIcon from '../../assets/stack/frontend/tailwindcss.svg'
import zustandIcon from '../../assets/stack/frontend/zustand.svg'
import flutterIcon from '../../assets/stack/frontend/flutter.svg'
import expoIcon from '../../assets/stack/frontend/expo.svg'
import expoIconLight from '../../assets/stack/frontend/expo-ligth.svg'
import astroIcon from '../../assets/stack/frontend/astro-dark.svg'
import astroIconLight from '../../assets/stack/frontend/astro-light.svg'

// Import backend images
import nodejsIcon from '../../assets/stack/backend/nodejs.svg'
import bunIcon from '../../assets/stack/backend/bun.svg'
import nextjsIcon from '../../assets/stack/backend/nextjs_icon_dark.svg'
import supabaseIcon from '../../assets/stack/backend/supabase.svg'
import postgresqlIcon from '../../assets/stack/backend/postgresql.svg'
import pythonIcon from '../../assets/stack/backend/python.svg'

// Import tools images
import gitIcon from '../../assets/stack/tools/git.svg'
import githubIcon from '../../assets/stack/tools/github-dark.svg'
import githubIconLight from '../../assets/stack/tools/github-light.svg'
import bashIcon from '../../assets/stack/tools/bash_dark.svg'
import bashIconLight from '../../assets/stack/tools/bash-light.svg'
import cursorIcon from '../../assets/stack/tools/cursor.webp'
import postmanIcon from '../../assets/stack/tools/postman.svg'
import linuxIcon from '../../assets/stack/tools/linux.svg'
import vercelIcon from '../../assets/stack/tools/vercel_dark.svg'
import vercelIconLight from '../../assets/stack/tools/vercel-light.svg'

// Import learning images
import redisIcon from '../../assets/stack/learning/redis.svg'
import awsIcon from '../../assets/stack/learning/aws_dark.svg'
import awsIconLight from '../../assets/stack/learning/aws-ligth.svg'
import ollamaIcon from '../../assets/stack/learning/ollama_dark.svg'
import ollamaIconLight from '../../assets/stack/learning/ollama-light.svg'
import rustIcon from '../../assets/stack/learning/rust_dark.svg'
import rustIconLight from '../../assets/stack/learning/rust-light.svg'

// Detect theme (dark or light) once
let theme = 'light'
if (typeof window !== 'undefined') {
  theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light'
}

type IStack = {
  title: string,
  stack: {
    name: string,
    dark: any,
    light?: any
  }[]
}

const stacks: IStack[] = [
  {
    title: 'Frontend',
    stack: [
      { name: 'Astro', dark: astroIcon, light: astroIconLight },
      { name: 'React', dark: reactIcon },
      { name: 'Next.js', dark: nextjsIcon },
      { name: 'TypeScript', dark: typescriptIcon },
      { name: 'JavaScript', dark: javascriptIcon },
      { name: 'Tailwind CSS', dark: tailwindIcon },
      { name: 'Zustand', dark: zustandIcon },
      { name: 'HTML', dark: html5Icon },
      { name: 'CSS', dark: cssIcon },
      { name: 'Flutter', dark: flutterIcon },
      { name: 'Expo', dark: expoIcon, light: expoIconLight }
    ]
  },
  {
    title: 'Backend & Cloud',
    stack: [
      { name: 'Node.js', dark: nodejsIcon },
      { name: 'Bun', dark: bunIcon },
      { name: 'Next.js API', dark: nextjsIcon },
      { name: 'Supabase', dark: supabaseIcon },
      { name: 'PostgreSQL', dark: postgresqlIcon },
      { name: 'Python', dark: pythonIcon }
    ]
  },
  {
    title: 'Tools',
    stack: [
      { name: 'Git', dark: gitIcon },
      { name: 'GitHub', dark: githubIcon, light: githubIconLight },
      { name: 'Terminal', dark: bashIcon, light: bashIconLight },
      { name: 'Cursor', dark: cursorIcon },
      { name: 'Postman', dark: postmanIcon },
      { name: 'Linux', dark: linuxIcon },
      { name: 'Vercel', dark: vercelIcon, light: vercelIconLight }
    ]
  },
  {
    title: 'Learning',
    stack: [
      { name: 'AI', dark: ollamaIcon, light: ollamaIconLight },
      { name: 'Rust', dark: rustIcon, light: rustIconLight },
      { name: 'AWS', dark: awsIcon, light: awsIconLight },
      { name: 'Redis', dark: redisIcon }
    ]
  }
]

const { t } = Astro.props;
---

<section id='stack' aria-label='stack' class='space-y-8 sm:space-y-12'>
  <div class='text-center'>
    <h2 class='text-3xl sm:text-4xl lg:text-5xl font-bold'>{t.title}</h2>
    <p class='text-base sm:text-lg text-muted-foreground mt-2 max-w-2xl mx-auto'>
      {t.description}
    </p>
  </div>
  <div class='grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8'>
    {stacks.map(({ title, stack }) => (
      <Card className='hover:shadow-lg transition-all duration-300'>
        <CardHeader>
          <CardTitle>
            <h3 class='text-xl sm:text-2xl font-bold'>{title}</h3>
          </CardTitle>
        </CardHeader>
        <CardContent>
          <div class='grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-5 gap-4 sm:gap-6'>
            {stack.map(({ name, dark, light }) => (
              <div class='text-center flex flex-col items-center justify-center gap-2 group'>
                <div class='w-16 h-16 flex items-center justify-center mb-1 bg-transparent'>
                  {light ? (
                    <>
                      <Image
                        src={dark}
                        alt={name}
                        width='48'
                        height='48'
                        class='transition-transform duration-200 group-hover:scale-110 max-h-12 max-w-12 dark:block hidden'
                        loading='lazy'
                      />
                      <Image
                        src={light}
                        alt={name}
                        width='48'
                        height='48'
                        class='transition-transform duration-200 group-hover:scale-110 max-h-12 max-w-12 dark:hidden block'
                        loading='lazy'
                      />
                    </>
                  ) : (
                    <Image
                      src={dark}
                      alt={name}
                      width='48'
                      height='48'
                      class='transition-transform duration-200 group-hover:scale-110 max-h-12 max-w-12'
                      loading='lazy'
                    />
                  )}
                </div>
                <p class='text-xs sm:text-sm font-medium text-muted-foreground group-hover:text-foreground transition-colors duration-200 leading-tight min-h-[1.75rem] flex items-center justify-center'>{name}</p>
              </div>
            ))}
          </div>
        </CardContent>
      </Card>
    ))}
  </div>
</section>